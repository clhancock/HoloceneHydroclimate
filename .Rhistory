for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(40, 'points'),
legend.key.height=unit(10, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=20),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 6*0.5072, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'TS',sep=''))
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(40, 'points'),
legend.key.height=unit(10, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=20),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 5, height = 2.5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'TS.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 2,5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'Map.png',sep=''))
pcMapplot
paste(file.path(githubDir,'Figures','global_PC'),pc,'Map.png',sep=''))
pc
paste(file.path(githubDir,'Figures','global_PC'),pc,'Map.png',sep=''))
paste(file.path(githubDir,'Figures','global_PC'),pc,'Map.png',sep='')
ggsave(plot=pcMapplot, width = 5, height = 2,5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'Map.png',sep=''))
pcMapplot
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(40, 'points'),
legend.key.height=unit(10, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 2,5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep='')
paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep='')
?ggsave
ggsave(plot=pcMapplot, width = 5, height = 2,5, dpi = 600,device='png',
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(40, 'points'),
legend.key.height=unit(10, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 2,5, dpi = 600,device='png',
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 2,5, dpi = 600,#device='png',
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
class(pcMapplot)
class(pcTSplot)
ggsave(plot=pcMapplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(40, 'points'),
legend.key.height=unit(10, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(40, 'points'),
legend.key.height=unit(10, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 5, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(5, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(5, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3.5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='Black'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(8, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3.5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(8, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3.4, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(8, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3.5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 1
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(8, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3.5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
pc <- 2
dataTable <- fortify(refrenceSubset)
dataTable$Count     <- NA
for (reg in list(levels(refrenceSubset@data[["Acronym"]]))[[1]]){
i = which(refregions@data[["Acronym"]]==reg)
loading <- apply(pca[["loadings"]][,pc,],1,median,na.rm=TRUE)[which(regNames==reg)]
dataTable$Count[which(dataTable$id==as.character(i-1))] <- loading
}
pcMapplot <- basemap +
#Add refrence regions boundaries
geom_map(data=refrenceSubset, map=dataTable, alpha=0.75, size=0.5, color='black' ,
aes(x=long, y=lat, group=group, map_id=id,fill=dataTable$Count)) +
scale_fill_binned(type = "viridis",name =paste('Loading (PC',pc,')',sep='')) +
theme(text = element_text(family='sans',size=12),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"),
legend.position = c(0.5,0.12),
legend.direction='horizontal',
legend.box.background=element_rect(fill = 'white',color='Black'),
legend.box.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"),
legend.key.width=unit(30, 'points'),
legend.key.height=unit(8, 'points'))
pcTSplot <- ggplot() +
geom_line(aes(x=pca[["age"]]/1000,y=apply(pca[["PCs"]][,pc,],1,median,na.rm=TRUE)),
color='Black',size=1)+
labs(x='Age (yr BP)',y='Wet <    > Dry',subtitle=paste('PC',pc,sep='')) +
theme_bw() +
scale_x_reverse(name = "Age (ka BP)",
limits=c(12,0), expand=c(0,0), n.breaks=7) +
theme(text = element_text(family='sans',size=18),
plot.background = element_rect(fill = 'white',color='White'),
plot.margin = unit(c(0.25, 0.25, 0.2, 0.2), "in"))
ggsave(plot=pcTSplot, width = 6, height = 3, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_TS.png',sep=''))
ggsave(plot=pcMapplot, width = 6, height = 3.5, dpi = 600,
filename = paste(file.path(githubDir,'Figures','global_PC'),pc,'_Map.png',sep=''))
#which(regNames=reg)
#Load PCA data
#pca <- readRDS(file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
# plotPcaEns(pca)
