} else if (TS_Poll[[ts]]$AgeControlMax < 4000 & TS_Poll[[ts]]$AgeControlN >= 6){
include <- TRUE
}
}
}
if (include){
TSids <- append(TSids,TS_Poll[[ts]]$paleoData_TSid)}
}
if(!is.na(unique(chronDataSelect$Dataset_ID)[ts+1])){print(Dselect$dataSetName)}
}
print(length(TSids))
View(as.data.frame(TSids))
write.csv(as.data.frame(TSids),"/Users/clh624/Desktop/Data")
var     <- 'HC'
dir  <- getwd()
#dir  <- '/Volumes/GoogleDrive/My Drive/zResearch/Manuscript/2021_HoloceneHydroclimate/2021_HoloceneHydroclimate' #
lipdTSO <- readRDS(file.path(dir,'Data','Proxy','LiPD','lipdData.rds'))[[var]]
dir  <- getwd()
dir
var     <- 'HC'
#dir  <- getwd()
#dir  <- '/Volumes/GoogleDrive/My Drive/zResearch/Manuscript/2021_HoloceneHydroclimate/2021_HoloceneHydroclimate' #
lipdTSO <- readRDS(file.path(dir,'Data','Proxy','LiPD','lipdData.rds'))[[var]]
proxyDf <- read.csv(file=file.path(dir,'Data','Proxy',paste('proxyMetaData_',var,'2.csv',sep='')))
PROJ <- '+proj=robin   +ellps=WGS84 +datum=WGS84 +no_defs +lon_0=0 +x_0=0 +y_0=0 +units=m'
PROJorig <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
load(url('https://github.com/SantanderMetGroup/ATLAS/blob/main/reference-regions/IPCC-WGI-reference-regions-v4_R.rda?raw=true'))
refregions <-  spTransform(IPCC_WGI_reference_regions_v4, CRSobj = PROJ)
countries  <- rworldmap::getMap("less islands")
countries  <- sp::spTransform(countries,  CRSobj = PROJ)
proxyDf
View(TS_poll)
View(TS_Poll)
#df <- proxyDFprj %>% filter(paleoData_TSid==unique(proxyDFprj$paleoData_TSid)[i])
tso <- TS_Poll[[ts]]
tso$age
tso$paleoData_values
tso$paleoData_HoloceneValues <- data.frame(age = as.numeric(tso$age),
values = as.numeric(tso$paleoData_values)) %>%
filter(between(age,-100,12400)) %>%
filter(!is.na(values)) %>%
arrange(age) # tso$paleoData_HoloceneValues
tso$paleoData_HoloceneValues
tso$paleoData_HoloceneValues
as.numeric(tso$age)
c(as.numeric(tso$age),as.numeric(tso$age)[c(2,length(tso$age)-1)])
c(as.numeric(tso$age),as.numeric(tso$age)[-c(2,length(tso$age)-1)])
c(as.numeric(tso$age),as.numeric(tso$age)[c(2:length(tso$age)-1)])
c(as.numeric(tso$age))
as.numeric(tso$age)[c(2:length(tso$age)-1)]
as.numeric(tso$age)[c(2:(length(tso$age)-1))]
length(as.numeric(tso$age)[c(2:(length(tso$age)-1))])
as.numeric(tso$paleoData_values)
c(as.numeric(tso$age),as.numeric(tso$age)[c(2:(length(tso$age)-1))])
as.numeric(tso$paleoData_values)
as.numeric(tso$age)
i <- 2
tso$age
tso$age[2]
diff(tso$age)
ages <- c()
values <- c()
for (i in 1:length(ages)-1){
if (i == 1){
ages <- c(ages,tso$age[i])
values <- c(values,tso$paleoData_values[i])
} else{
ages <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]+diff(tso$age)[i]/2)
}
}
source("C:/Users/clh624/Desktop/HoloceneHydroclimate/Scripts/R/1_loadLiPD.R", echo=TRUE)
for (i in 1:(length(ages)-1)){
print(i)
if (i == 1){
ages <- c(ages,tso$age[i])
values <- c(values,tso$paleoData_values[i])
} else{
ages <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]+diff(tso$age)[i]/2)
}
}
#df <- proxyDFprj %>% filter(paleoData_TSid==unique(proxyDFprj$paleoData_TSid)[i])
tso <- TS_Poll[[ts]]
ages <- c()
values <- c()
for (i in 1:(length(ages)-1)){
print(i)
if (i == 1){
ages <- c(ages,tso$age[i])
values <- c(values,tso$paleoData_values[i])
} else{
ages <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]+diff(tso$age)[i]/2)
}
}
for (i in 1:(length(tso$age)-1)){
print(i)
if (i == 1){
ages <- c(ages,tso$age[i])
values <- c(values,tso$paleoData_values[i])
} else{
ages <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]+diff(tso$age)[i]/2)
}
}
ages
ages <- c()
values <- c()
for (i in 1:(length(tso$age)-1)){
print(i)
if (i == 1){
ages   <- c(ages,tso$age[i])
values <- c(values,tso$paleoData_values[i])
} else{
ages   <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]+diff(tso$age)[i]/2)
values <- c(values,tso$paleoData_values[i-1],tso$paleoData_values[i-1],tso$paleoData_values[i-1])
}
}
ages
values
tso$paleoData_values
ages <- c()
values <- c()
for (i in 1:length(tso$age)){
print(i)
if (i == 1){
ages   <- c(ages,tso$age[i],tso$age[i]+diff(tso$age)[i]/2)
values <- c(values,tso$paleoData_values[i],tso$paleoData_values[i])
} else if (i == length(tso$age)){
ages   <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i])
values <- c(values,tso$paleoData_values[i],tso$paleoData_values[i])
} else{
ages   <- c(ages,tso$age[i]-diff(tso$age)[i-1]/2,tso$age[i]+diff(tso$age)[i]/2)
values <- c(values,tso$paleoData_values[i],tso$paleoData_values[i])
}
}
ages
plt <- ggplot(df,aes(x=age,y=paleoData_values)) +
geom_hline(yintercept=mean(df$paleoData_values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7)
library(ggplot2)
plt <- ggplot(df,aes(x=age,y=paleoData_values)) +
geom_hline(yintercept=mean(df$paleoData_values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7)
library(ggstar)
ggplot(df,aes(x=age,y=paleoData_values)) +
geom_hline(yintercept=mean(df$paleoData_values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw()
ggplot(df,aes(x=age,y=paleoData_values)) +
geom_hline(yintercept=mean(df$paleoData_values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=1,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw()
ggplot(df,aes(x=age,y=paleoData_values)) +
geom_hline(yintercept=mean(df$paleoData_values,na.rm=TRUE))
df
df <- data.frame(
age    = c(as.numeric(tso$age),as.numeric(tso$age)[c(2:(length(tso$age)-1))]),
values = as.numeric(tso$paleoData_values)) %>%
filter(between(age,-100,12400)) %>%
filter(!is.na(values)) %>%
arrange(age) # tso$paleoData_HoloceneValues
df <- data.frame(
age    = c(as.numeric(tso$age),as.numeric(tso$age)[c(2:(length(tso$age)-1))]),
values = as.numeric(tso$paleoData_values)) %>%
filter(between(age,-100,12400)) %>%
filter(!is.na(values)) %>%
arrange(age) # tso$paleoData_HoloceneValues
df <- data.frame(
age    = as.numeric(tso$age),
values = as.numeric(tso$paleoData_values)) %>%
filter(between(age,-100,12400)) %>%
filter(!is.na(values)) %>%
arrange(age) # tso$paleoData_HoloceneValues
ggplot(df,aes(x=age,y=paleoData_values)) +
geom_hline(yintercept=mean(df$paleoData_values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=1,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7)
ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=1,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw()
df
ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=1,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7)
ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE))
ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=1,size=1,starstroke=0.5,alpha=0.7)
col <- 'black' #plotSettings$colors[which(plotSettings$names == ts$CategorySpecific)]
shp <- 'black' #plotSettings$shapes[which(plotSettings$names == ts$CategorySpecific)]
col <- 'black' #plotSettings$colors[which(plotSettings$names == ts$CategorySpecific)]
shp <- 1#plotSettings$shapes[which(plotSettings$names == ts$CategorySpecific)]
ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7)
plt <- ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt <- ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt <- ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
geom_line(aes(ages,values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot(df,aes(x=age,y=values)) +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(color=col,alpha=0.7) +
geom_line(aes(x=ages,y=values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
geom_line(aes(x=ages,y=values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
ages
values
lenth(values)
length(values)
length(ages)
dim(df)
df$age
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
#geom_line(aes(x=ages,y=values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
#geom_line(aes(x=ages,y=values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(17000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
geom_line(aes(x=ages,y=values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(17000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
values
diff(values)
ages
diff(ages)
qplot(ages,values)
qplot(ages,values,type='l')
qplot(ages,values,type='o')
qplot(ages,values,type='b')
qplot(ages,values,geom ='b')
qplot(ages,values,geom ='path')
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
geom_path(aes(x=ages,y=values),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(17000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
df
df$age
diff(df$age)
diff(df$age)/2
df$age
df$age[-1]
df$age[-1]-diff(df$age)/2
ages2<-c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)])
ages2
sort(ages2)
ages
df$age
df$values
rep(1:4, each=24/4)
rep(df$values, each=24/4)
rep(df$values, each=24/2)
rep(df$values, each=2)
values2 <- rep(df$values, each=2)
length(values2)
length(ages2)
ages2<-c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)])
values2 <- rep(df$values, each=2)
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
geom_path(aes(x=ages,y=values),color='red',alpha=0.7) +
geom_path(aes(x=ages2,y=values2),color='red',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(17000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
ages2<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values2 <- rep(df$values, each=2)
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_line(aes(x=df$age,y=df$values),color=col,alpha=0.7) +
geom_path(aes(x=ages,y=values),color='red',alpha=0.7) +
geom_path(aes(x=ages2,y=values2),color='green',alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(17000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=ages,y=values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(17000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=ages,y=values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),
n.breaks=7,sec.axis = sec_axis(~.,labels=NULL)) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=ages,y=values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),n.breaks=7,oob=scales::squish) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
df <- data.frame(
age    = as.numeric(tso$age),
values = as.numeric(tso$paleoData_values)) %>%
filter(between(age,-100,12400)) %>%
arrange(age) # tso$paleoData_HoloceneValues
ages<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values <- rep(df$values, each=2)
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=ages,y=values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),n.breaks=7,oob=scales::squish) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
ages
which(ages<12000)
max(which(ages<12000))
ages<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values <- rep(df$values, each=2)
if(max(ages)>=12000){
ages <- ages[1:max(which(ages<=12000))+1]
values <- values[1:max(which(ages<=12000))+1]
}
ages
ages<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values <- rep(df$values, each=2)
if(max(ages)>12000){
ages   <- ages[  1:max(which(ages<12000))+1]
values <- values[1:max(which(ages<12000))+1]
}
ages
if(min(ages)<1300){
ages   <- ages[  min(which(ages>1300))-1:length(ages)]
values <- values[min(which(ages>1300))-1:length(ages)]
}
min(which(ages>1300)
)
min(which(ages>1300))-1
ages<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values <- rep(df$values, each=2)
if(max(ages)>12000){
values <- values[1:max(which(ages<12000))+1]
ages   <- ages[  1:max(which(ages<12000))+1]
}
if(min(ages)<1300){
values <- values[min(which(ages>1300))-1:length(ages)]
ages   <- ages[  min(which(ages>1300))-1:length(ages)]
}
min(ages)
which(ages>1300)
ages<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values <- rep(df$values, each=2)
if(max(ages)>12000){
values <- values[1:max(which(ages<12000))+1]
ages   <- ages[  1:max(which(ages<12000))+1]
}
if(min(ages)<1300){
values <- values[(min(which(ages>1300))-1):length(ages)]
ages   <- ages[  (min(which(ages>1300))-1):length(ages)]
}
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=ages,y=values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),n.breaks=7,oob=scales::squish) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=df$age,y=df$values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),n.breaks=7,oob=scales::squish) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
plt
ages<-sort(c(df$age[1],df$age[-1]-diff(df$age)/2,df$age[-nrow(df)]+diff(df$age)/2,df$age[nrow(df)]))
values <- rep(df$values, each=2)
plt <- ggplot() +
geom_hline(yintercept=mean(df$values,na.rm=TRUE)) +
geom_star(aes(x=df$age,y=df$values),fill=col,color='black',starshape=shp,size=1,starstroke=0.5,alpha=0.7) +
geom_path(aes(x=ages,y=values),color=col,alpha=0.7) +
scale_x_reverse(name = "Age (yr BP)", limits=c(12000,0),expand=c(0,0),n.breaks=7,oob=scales::squish) +
theme_bw() +
#ggtitle(paste(unique(df[,'geo_ipccRegion']),': ',unique(df[,'dataSetName']),sep='')) +
theme(text = element_text(family='sans',size=8),
plot.title = element_text(hjust = 0.5,family='sans',size=10,face='bold'))
pkt
plt
dir  <- getwd()# '/Volumes/GoogleDrive/My Drive/zResearch/Manuscript/HoloceneHydroclimate/HoloceneHydroclimate' #
PROJ <- '+proj=robin   +ellps=WGS84 +datum=WGS84 +no_defs +lon_0=0 +x_0=0 +y_0=0 +units=m'
PROJorig <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
load(url('https://github.com/SantanderMetGroup/ATLAS/blob/main/reference-regions/IPCC-WGI-reference-regions-v4_R.rda?raw=true'))
refregions <-  spTransform(IPCC_WGI_reference_regions_v4, CRSobj = PROJ)
