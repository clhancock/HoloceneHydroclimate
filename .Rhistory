n.breaks=4) #+scale_y_reverse(name = 'oY')
pcaPlot <- pcaPlot + draw_plot(pcaTS, x = ((i-1)%%2)/2, y = (abs((i^2-2.5))-6.5)/-10,
width = 0.5, height = 0.5)
}
pcaPlot <- pcaPlot + draw_plot(plotScreeEns(pcaHC),
x = 0.5, y = 0,   width = 0.5, height = 0.5)
for (region in names(compositeData)[-1]){
nloading<-3
regionLoads <- data.frame(pc = 1:nloading, n=rep(1,nloading), loadings= as.numeric(pcaHCLoadings[region,][1:nloading]))
plotData[[region]]$PCAloadings <- ggplot(regionLoads) +
geom_point(aes(x=pc,y=n,colour=loadings),size=abs(regionLoads$loadings)*20,show.legend = FALSE) +
scale_x_continuous(limits=c(0.5,nloading+0.5), expand=c(0,0)) +
#scale_y_continuous(limits=c(0,1), expand=c(0,0)) +
scale_color_distiller(palette='PuOr',
#na.value=colorNAval,
direction=colorDir,
limits = c(-0.3,0.3),
#guide=guide_coloursteps(show.limits=FALSE)
oob=squish) +
theme_void() +
theme(panel.background=element_rect(color='black',fill='white',size=0.5))
}
for (plotType in c('PCAloadings')){#'StripePlot','CompBands')){#},'SlopeFig',,#'plotTS','cmipPlt'
#'UncertaintyBands','ProxyModel','pieAgreement')){ #'corOutFig'
#Some more settings
#Do the plotting thing
if (plotType %in% c('PCAloadings','plotTS','UncertaintyBands','ProxyModel','cmipPlt','CompBands',
'StripePlot','SlopeFig','corOutFig')){
if (plotType %in% c('StripePlot','SlopeFig')){
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
} else{
mapPlot <- ggdraw() + draw_plot(baseMap,      x = 0, y = 0, width = 1, height = 1)
}
for (region in names(compositeData)[-1]){
if (plotType=='corOutFig' & region == 'NWS') next
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.08
stripeY <- 0.055
if (       region == 'ENA'){
xNudge <- 0.035
} else if (region == 'WNA'){
xNudge <- -0.04
} else if (region == 'ECA'){
yNudge <- 0.01
} else if (region == 'SAU'){
xNudge <- -0.01
} else if (region == 'WCA'){
xNudge <- -0.005
} else if (region == 'SAM'){
yNudge <- -0.015
} else if (region == 'NES'){
yNudge <- +0.02
} else if (region == 'WSAF'){
yNudge <- -0.02
} else if (region == 'ESAF'){
yNudge <- +0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[plotType]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
ggsave(filename = paste(plotType,'_',climVar,'.png',sep=''),
plot=mapPlot,
path= file.path(githubDir,'Figures'),
width=6,height=(6/1.97+0.5),dpi = 600,device='png')
} else if (plotType=='pieAgreement'){
for (timeperiod in c('12_0','12_6','6_0')){
plotType <- paste('SlopeFig_',timeperiod,sep='')
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
for (region in names(compositeData)[-1]){
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.12
stripeY <- 0.12
if (       region == 'ENA'){
xNudge <- 0.01
} else if (region == 'WNA'){
xNudge <- -0.02
} else if (region == 'MED'){
xNudge <- -0.015
} else if (region == 'WCE'){
xNudge <- 0.02
} else if (region == 'SAH'){
xNudge <- -0.04
} else if (region == 'WCA'){
xNudge <- 0
} else if (region == 'ECA'){
xNudge <- -0.02
yNudge <- 0.01
} else if (region == 'ESB'){
xNudge <- 0.01
} else if (region == 'TIB'){
xNudge <- 0.025
yNudge <- -0.01
} else if (region == 'SAS'){
yNudge <- -0.025
} else if (region == 'NCA'){
xNudge <- -0.01
yNudge <- -0.01
} else if (region == 'NEAF'){
yNudge <- 0.02
} else if (region == 'SEAF'){
yNudge <- -0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[paste('SlopeFig_',timeperiod,sep='')]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
#ggsave(paste(plotType,'_',climateVariable,'.png',sep=''),mapPlot,
# path=paste(githubDir,'Figures/',sep=''),
# width=6,height=(6/1.97+0.5),dpi = 600,device='png')
}
}
}
max(abs(pcaHCLoadings))
pcaHC <- readRDS(file = file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
pcaHCLoadings <- readRDS(file = file.path(githubDir,'Data','RegionComposites','PCA','pcaLoadingsMean.rds'))
plotData[[region]]$Regions
pcaPlot <- ggdraw()
for (i in 1:3){
pcaTS <- plotTimeseriesEnsRibbons(X = pcaHC$age, Y = pcaHC$PCs[,i,]) +
scale_x_reverse(name = "Age (yr BP)",
limits=c(12000,0),
expand=c(0,0),
n.breaks=4) #+scale_y_reverse(name = 'oY')
pcaPlot <- pcaPlot + draw_plot(pcaTS, x = ((i-1)%%2)/2, y = (abs((i^2-2.5))-6.5)/-10,
width = 0.5, height = 0.5)
}
pcaPlot <- pcaPlot + draw_plot(plotScreeEns(pcaHC),
x = 0.5, y = 0,   width = 0.5, height = 0.5)
for (region in names(compositeData)[-1]){
nloading<-3
regionLoads <- data.frame(pc = 1:nloading, n=rep(1,nloading), loadings= as.numeric(pcaHCLoadings[region,][1:nloading]))
plotData[[region]]$PCAloadings <- ggplot(regionLoads) +
geom_point(aes(x=pc,y=n,colour=loadings),size=abs(regionLoads$loadings)*20,show.legend = FALSE) +
scale_x_continuous(limits=c(0.5,nloading+0.5), expand=c(0,0)) +
#scale_y_continuous(limits=c(0,1), expand=c(0,0)) +
scale_color_distiller(palette='PuOr',
#na.value=colorNAval,
direction=colorDir,
limits = c(-0.5,0.5),
#guide=guide_coloursteps(show.limits=FALSE)
oob=squish) +
theme_void() +
theme(panel.background=element_rect(color='black',fill='white',size=0.5))
}
for (plotType in c('PCAloadings')){#'StripePlot','CompBands')){#},'SlopeFig',,#'plotTS','cmipPlt'
#'UncertaintyBands','ProxyModel','pieAgreement')){ #'corOutFig'
#Some more settings
#Do the plotting thing
if (plotType %in% c('PCAloadings','plotTS','UncertaintyBands','ProxyModel','cmipPlt','CompBands',
'StripePlot','SlopeFig','corOutFig')){
if (plotType %in% c('StripePlot','SlopeFig')){
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
} else{
mapPlot <- ggdraw() + draw_plot(baseMap,      x = 0, y = 0, width = 1, height = 1)
}
for (region in names(compositeData)[-1]){
if (plotType=='corOutFig' & region == 'NWS') next
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.08
stripeY <- 0.055
if (       region == 'ENA'){
xNudge <- 0.035
} else if (region == 'WNA'){
xNudge <- -0.04
} else if (region == 'ECA'){
yNudge <- 0.01
} else if (region == 'SAU'){
xNudge <- -0.01
} else if (region == 'WCA'){
xNudge <- -0.005
} else if (region == 'SAM'){
yNudge <- -0.015
} else if (region == 'NES'){
yNudge <- +0.02
} else if (region == 'WSAF'){
yNudge <- -0.02
} else if (region == 'ESAF'){
yNudge <- +0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[plotType]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
ggsave(filename = paste(plotType,'_',climVar,'.png',sep=''),
plot=mapPlot,
path= file.path(githubDir,'Figures'),
width=6,height=(6/1.97+0.5),dpi = 600,device='png')
} else if (plotType=='pieAgreement'){
for (timeperiod in c('12_0','12_6','6_0')){
plotType <- paste('SlopeFig_',timeperiod,sep='')
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
for (region in names(compositeData)[-1]){
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.12
stripeY <- 0.12
if (       region == 'ENA'){
xNudge <- 0.01
} else if (region == 'WNA'){
xNudge <- -0.02
} else if (region == 'MED'){
xNudge <- -0.015
} else if (region == 'WCE'){
xNudge <- 0.02
} else if (region == 'SAH'){
xNudge <- -0.04
} else if (region == 'WCA'){
xNudge <- 0
} else if (region == 'ECA'){
xNudge <- -0.02
yNudge <- 0.01
} else if (region == 'ESB'){
xNudge <- 0.01
} else if (region == 'TIB'){
xNudge <- 0.025
yNudge <- -0.01
} else if (region == 'SAS'){
yNudge <- -0.025
} else if (region == 'NCA'){
xNudge <- -0.01
yNudge <- -0.01
} else if (region == 'NEAF'){
yNudge <- 0.02
} else if (region == 'SEAF'){
yNudge <- -0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[paste('SlopeFig_',timeperiod,sep='')]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
#ggsave(paste(plotType,'_',climateVariable,'.png',sep=''),mapPlot,
# path=paste(githubDir,'Figures/',sep=''),
# width=6,height=(6/1.97+0.5),dpi = 600,device='png')
}
}
}
pcaHC <- readRDS(file = file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
pcaHCLoadings <- readRDS(file = file.path(githubDir,'Data','RegionComposites','PCA','pcaLoadingsMean.rds'))
plotData[[region]]$Regions
pcaPlot <- ggdraw()
for (i in 1:3){
pcaTS <- plotTimeseriesEnsRibbons(X = pcaHC$age, Y = pcaHC$PCs[,i,]) +
scale_x_reverse(name = "Age (yr BP)",
limits=c(12000,0),
expand=c(0,0),
n.breaks=4) #+scale_y_reverse(name = 'oY')
pcaPlot <- pcaPlot + draw_plot(pcaTS, x = ((i-1)%%2)/2, y = (abs((i^2-2.5))-6.5)/-10,
width = 0.5, height = 0.5)
}
pcaPlot <- pcaPlot + draw_plot(plotScreeEns(pcaHC),
x = 0.5, y = 0,   width = 0.5, height = 0.5)
for (region in names(compositeData)[-1]){
nloading<-3
regionLoads <- data.frame(pc = 1:nloading, n=rep(1,nloading), loadings= as.numeric(pcaHCLoadings[region,][1:nloading]))
plotData[[region]]$PCAloadings <- ggplot(regionLoads) +
geom_point(aes(x=pc,y=n,colour=loadings),size=abs(regionLoads$loadings)*20,show.legend = FALSE) +
scale_x_continuous(limits=c(0.5,nloading+0.5), expand=c(0,0)) +
#scale_y_continuous(limits=c(0,1), expand=c(0,0)) +
scale_color_distiller(palette='PuOr',
#na.value=colorNAval,
direction=colorDir,
limits = c(-0.4,0.4),
#guide=guide_coloursteps(show.limits=FALSE)
oob=squish) +
theme_void() +
theme(panel.background=element_rect(color='black',fill='white',size=0.5))
}
for (plotType in c('PCAloadings')){#'StripePlot','CompBands')){#},'SlopeFig',,#'plotTS','cmipPlt'
#'UncertaintyBands','ProxyModel','pieAgreement')){ #'corOutFig'
#Some more settings
#Do the plotting thing
if (plotType %in% c('PCAloadings','plotTS','UncertaintyBands','ProxyModel','cmipPlt','CompBands',
'StripePlot','SlopeFig','corOutFig')){
if (plotType %in% c('StripePlot','SlopeFig')){
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
} else{
mapPlot <- ggdraw() + draw_plot(baseMap,      x = 0, y = 0, width = 1, height = 1)
}
for (region in names(compositeData)[-1]){
if (plotType=='corOutFig' & region == 'NWS') next
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.08
stripeY <- 0.055
if (       region == 'ENA'){
xNudge <- 0.035
} else if (region == 'WNA'){
xNudge <- -0.04
} else if (region == 'ECA'){
yNudge <- 0.01
} else if (region == 'SAU'){
xNudge <- -0.01
} else if (region == 'WCA'){
xNudge <- -0.005
} else if (region == 'SAM'){
yNudge <- -0.015
} else if (region == 'NES'){
yNudge <- +0.02
} else if (region == 'WSAF'){
yNudge <- -0.02
} else if (region == 'ESAF'){
yNudge <- +0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[plotType]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
ggsave(filename = paste(plotType,'_',climVar,'.png',sep=''),
plot=mapPlot,
path= file.path(githubDir,'Figures'),
width=6,height=(6/1.97+0.5),dpi = 600,device='png')
} else if (plotType=='pieAgreement'){
for (timeperiod in c('12_0','12_6','6_0')){
plotType <- paste('SlopeFig_',timeperiod,sep='')
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
for (region in names(compositeData)[-1]){
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.12
stripeY <- 0.12
if (       region == 'ENA'){
xNudge <- 0.01
} else if (region == 'WNA'){
xNudge <- -0.02
} else if (region == 'MED'){
xNudge <- -0.015
} else if (region == 'WCE'){
xNudge <- 0.02
} else if (region == 'SAH'){
xNudge <- -0.04
} else if (region == 'WCA'){
xNudge <- 0
} else if (region == 'ECA'){
xNudge <- -0.02
yNudge <- 0.01
} else if (region == 'ESB'){
xNudge <- 0.01
} else if (region == 'TIB'){
xNudge <- 0.025
yNudge <- -0.01
} else if (region == 'SAS'){
yNudge <- -0.025
} else if (region == 'NCA'){
xNudge <- -0.01
yNudge <- -0.01
} else if (region == 'NEAF'){
yNudge <- 0.02
} else if (region == 'SEAF'){
yNudge <- -0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[paste('SlopeFig_',timeperiod,sep='')]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
#ggsave(paste(plotType,'_',climateVariable,'.png',sep=''),mapPlot,
# path=paste(githubDir,'Figures/',sep=''),
# width=6,height=(6/1.97+0.5),dpi = 600,device='png')
}
}
}
pcaHC <- readRDS(file = file.path(githubDir,'Data','RegionComposites','PCA','pcaHC12k.rds'))
pcaHCLoadings <- readRDS(file = file.path(githubDir,'Data','RegionComposites','PCA','pcaLoadingsMean.rds'))
plotData[[region]]$Regions
pcaPlot <- ggdraw()
for (i in 1:3){
pcaTS <- plotTimeseriesEnsRibbons(X = pcaHC$age, Y = pcaHC$PCs[,i,]) +
scale_x_reverse(name = "Age (yr BP)",
limits=c(12000,0),
expand=c(0,0),
n.breaks=4) #+scale_y_reverse(name = 'oY')
pcaPlot <- pcaPlot + draw_plot(pcaTS, x = ((i-1)%%2)/2, y = (abs((i^2-2.5))-6.5)/-10,
width = 0.5, height = 0.5)
}
pcaPlot <- pcaPlot + draw_plot(plotScreeEns(pcaHC),
x = 0.5, y = 0,   width = 0.5, height = 0.5)
for (region in names(compositeData)[-1]){
nloading<-3
regionLoads <- data.frame(pc = 1:nloading, n=rep(1,nloading), loadings= as.numeric(pcaHCLoadings[region,][1:nloading]))
plotData[[region]]$PCAloadings <- ggplot(regionLoads) +
geom_point(aes(x=pc,y=n,colour=loadings),size=abs(regionLoads$loadings)*20,show.legend = FALSE) +
scale_x_continuous(limits=c(0.5,nloading+0.5), expand=c(0,0)) +
#scale_y_continuous(limits=c(0,1), expand=c(0,0)) +
scale_color_distiller(palette='Spectral',
#na.value=colorNAval,
direction=colorDir,
limits = c(-0.4,0.4),
#guide=guide_coloursteps(show.limits=FALSE)
oob=squish) +
theme_void() +
theme(panel.background=element_rect(color='black',fill='white',size=0.5))
}
for (plotType in c('PCAloadings')){#'StripePlot','CompBands')){#},'SlopeFig',,#'plotTS','cmipPlt'
#'UncertaintyBands','ProxyModel','pieAgreement')){ #'corOutFig'
#Some more settings
#Do the plotting thing
if (plotType %in% c('PCAloadings','plotTS','UncertaintyBands','ProxyModel','cmipPlt','CompBands',
'StripePlot','SlopeFig','corOutFig')){
if (plotType %in% c('StripePlot','SlopeFig')){
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
} else{
mapPlot <- ggdraw() + draw_plot(baseMap,      x = 0, y = 0, width = 1, height = 1)
}
for (region in names(compositeData)[-1]){
if (plotType=='corOutFig' & region == 'NWS') next
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.08
stripeY <- 0.055
if (       region == 'ENA'){
xNudge <- 0.035
} else if (region == 'WNA'){
xNudge <- -0.04
} else if (region == 'ECA'){
yNudge <- 0.01
} else if (region == 'SAU'){
xNudge <- -0.01
} else if (region == 'WCA'){
xNudge <- -0.005
} else if (region == 'SAM'){
yNudge <- -0.015
} else if (region == 'NES'){
yNudge <- +0.02
} else if (region == 'WSAF'){
yNudge <- -0.02
} else if (region == 'ESAF'){
yNudge <- +0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[plotType]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
ggsave(filename = paste(plotType,'_',climVar,'.png',sep=''),
plot=mapPlot,
path= file.path(githubDir,'Figures'),
width=6,height=(6/1.97+0.5),dpi = 600,device='png')
} else if (plotType=='pieAgreement'){
for (timeperiod in c('12_0','12_6','6_0')){
plotType <- paste('SlopeFig_',timeperiod,sep='')
mapPlot <- ggdraw() + draw_plot(baseMapScale, x = 0, y = 0, width = 1, height = 1)
for (region in names(compositeData)[-1]){
xNudge  <- 0
yNudge  <- 0
stripeX <- 0.12
stripeY <- 0.12
if (       region == 'ENA'){
xNudge <- 0.01
} else if (region == 'WNA'){
xNudge <- -0.02
} else if (region == 'MED'){
xNudge <- -0.015
} else if (region == 'WCE'){
xNudge <- 0.02
} else if (region == 'SAH'){
xNudge <- -0.04
} else if (region == 'WCA'){
xNudge <- 0
} else if (region == 'ECA'){
xNudge <- -0.02
yNudge <- 0.01
} else if (region == 'ESB'){
xNudge <- 0.01
} else if (region == 'TIB'){
xNudge <- 0.025
yNudge <- -0.01
} else if (region == 'SAS'){
yNudge <- -0.025
} else if (region == 'NCA'){
xNudge <- -0.01
yNudge <- -0.01
} else if (region == 'NEAF'){
yNudge <- 0.02
} else if (region == 'SEAF'){
yNudge <- -0.02
}
mapPlot <- mapPlot +
draw_plot(plotData[[region]][[paste('SlopeFig_',timeperiod,sep='')]],
y = yNudge+(0.5-stripeY/2)+0.80*plotData[[region]]$plotLat/(8625155*2),
x = xNudge+(0.5-stripeX/2)+0.48*plotData[[region]]$plotLon/(9050504*2),
width = stripeX, height = stripeY)
}
mapPlot
#ggsave(paste(plotType,'_',climateVariable,'.png',sep=''),mapPlot,
# path=paste(githubDir,'Figures/',sep=''),
# width=6,height=(6/1.97+0.5),dpi = 600,device='png')
}
}
}
